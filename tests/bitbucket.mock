#!/bin/bash

set -euo pipefail

# .
# ├── _id          # unique identifier (generated by blankd)
# ├── raw          # raw request
# ├── method       # request method in uppercase
# ├── host         # request host from Host: header
# ├── uri
# │   ├── raw      # raw request URI
# │   ├── path     # URI path without query
# │   ├── query    # URI query without path
# │   └── values   # URI form values in 'key=value' format
# ├── headers
# │   ├── raw      # raw request headers
# │   └── values   # request headers in 'key=value' format
# ├── cookies      # request cookies in 'key=value' format
# └── body
#     ├── raw      # raw request body
#     └── values   # request form values in 'key=value' format

ln -sf "$1" bitbucket_request

if [[ -f bitbucket_response ]]; then
    cat bitbucket_response
    rm bitbucket_response
    exit 0
fi

if [[ -f bitbucket_response_2 ]]; then
    cat bitbucket_response_2
    rm bitbucket_response_2
    exit 0
fi

if [[ -f bitbucket_response_3 ]]; then
    cat bitbucket_response_3
    rm bitbucket_response_3
    exit 0
fi
